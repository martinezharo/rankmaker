---
// CategorySection.astro â€” 4-card grid per category
import TemplateCard from "./TemplateCard.astro";

interface Template {
    id: string;
    slug: string;
    title: string;
    description: string | null;
    category: string | null;
    cover_image: string | null;
    times_ranked: number;
}

interface Props {
    category: string;
    icon: string;
    templates: Template[];
}

const { category, icon, templates } = Astro.props;

if (templates.length === 0) return;

const anchorId = `cat-${category.toLowerCase().replace(/[^a-z0-9]/g, "-")}`;
---

<section id={anchorId} class="py-8">
    <!-- Section Header -->
    <div class="flex items-center gap-3 mb-5">
        <div
            class="w-9 h-9 rounded-xl bg-primary/10 flex items-center justify-center shrink-0"
        >
            <i class={`fa-solid ${icon} text-primary text-sm`}></i>
        </div>
        <h2 class="text-lg font-bold text-text-primary tracking-tight">
            {category}
        </h2>
        <div class="flex-1 h-px bg-border/50 ml-2"></div>
        <a
            href={`/search?category=${encodeURIComponent(category)}`}
            class="text-xs font-semibold text-text-secondary hover:text-primary transition-colors whitespace-nowrap ml-2 group"
        >
            View all <i
                class="fa-solid fa-arrow-right ml-1 text-[10px] transition-transform group-hover:translate-x-0.5"
            ></i>
        </a>
    </div>

    <!-- Cards: horizontal scroll on mobile, 4-col grid on desktop -->
    <div
        class="flex gap-4 overflow-x-auto scrollbar-hide pb-2 snap-x snap-mandatory md:grid md:grid-cols-4 md:overflow-x-visible md:snap-none"
    >
        {
            templates.map((template) => (
                <div class="min-w-[70vw] sm:min-w-[45vw] md:min-w-0 snap-start">
                    <TemplateCard template={template} />
                </div>
            ))
        }
    </div>
</section>
